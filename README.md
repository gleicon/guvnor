# Guv'nor

> Simple, fast web application deployment and process management

**Guv'nor** replaces nginx+systemd+docker-compose with a single binary. Zero configuration required - just works!

## Key Features

**Zero Configuration** - Auto-detects Python, Node.js, Go, Rust apps  
**Automatic TLS** - Let's Encrypt certificates with zero setup  
**Lightning Fast** - Sub-second startup, optimized for speed  
**Smart Defaults** - Works perfectly out of the box  
**Single Binary** - No dependencies, easy deployment  
**Hot Reload** - Automatic restarts and health monitoring  

## Quick Start

### Zero Config Deployment
```bash
# In any directory with apps (Python, Node.js, Go, Rust)
guvnor init

# Output:
# Initializing Guv'nor in: .
# Detecting applications...
# Found 2 applications:
#   - my-api (python)
#   - my-web (nodejs)
# Created: Procfile
# Created: .env
# Created: guvnor.yaml

# Start everything
guvnor start
```

### Production Deployment
```bash
# Deploy with automatic TLS
guvnor start --domain myapp.com --email admin@myapp.com

# Automatic:
# - Let's Encrypt certificates
# - Domain routing
# - Health monitoring
# - Process management
```

## Smart Detection

Guv'nor automatically detects and optimally configures:

### Python Applications
- **Django**: Auto-detects `manage.py`, configures `runserver`
- **Flask**: Finds Flask app, sets `FLASK_APP` environment
- **FastAPI**: Detects FastAPI imports, configures `uvicorn`
- **Streamlit**: Finds streamlit apps, configures ports

### Node.js Applications  
- **Express**: Auto-detects Express dependencies
- **Next.js**: Configures dev/production modes
- **React**: Sets up development server
- **Generic**: Uses `package.json` scripts smartly

### Other Languages
- **Go**: Detects `go.mod`, runs with `go run .`
- **Rust**: Finds `Cargo.toml`, uses `cargo run`
- **Docker**: Detects `Dockerfile`, manages containers

## Usage Examples

### Basic Commands
```bash
# Initialize and start applications
guvnor init                      # Setup configuration
guvnor start                     # Start all processes
guvnor start --daemon            # Run as background daemon

# Management
guvnor status                    # Show all processes
guvnor stop                      # Stop all processes
guvnor restart web               # Restart specific process
guvnor logs                      # View logs
guvnor logs -f                   # Follow logs in real-time
guvnor shell                     # Interactive management
guvnor validate                  # Check configuration
```

### Smart Configuration Generation

```bash
# Auto-generate optimized config
guvnor init

# Generated config includes:
# - Detected app types and frameworks
# - Optimal ports and health checks  
# - Development-friendly defaults
# - Production deployment settings
```

## Configuration

### Auto-Generated Config (guvnor.yaml)
```yaml
# Generated automatically by 'guvnor init'
server:
  http_port: 8080      # Non-privileged for development  
  https_port: 8443     # Non-privileged for development
  log_level: info

apps:
  - name: my-api
    domain: my-api.localhost    # Smart local domain
    port: 8000                 # Framework-appropriate port
    command: uvicorn           # Auto-detected FastAPI
    args: ["main:app", "--host", "0.0.0.0", "--port", "8000"]
    health_check:
      enabled: true
      path: /docs             # FastAPI-specific health check
      interval: 30s
      timeout: 5s
      retries: 3
    restart_policy:
      enabled: true
      max_retries: 5          # Development-friendly
      backoff: 3s

tls:
  enabled: false              # Disabled for local development
  auto_cert: true            # Ready for production
```

### Production Configuration
```yaml
# Production settings
server:
  http_port: 80              # Standard HTTP
  https_port: 443           # Standard HTTPS
  log_level: warn           # Production logging

apps:
  - name: my-api
    domain: api.myapp.com    # Production domain
    # ... optimized for production

tls:
  enabled: true             # TLS enabled
  auto_cert: true          # Let's Encrypt
  email: admin@myapp.com   # ACME contact
  force_https: true        # Redirect HTTP->HTTPS
```

## Procfile Support

Guv'nor is fully compatible with Heroku/Foreman Procfiles:

```procfile
# Procfile - Generated by Guv'nor
web: gunicorn app.wsgi:application --bind 0.0.0.0:$PORT
worker: celery -A app worker --loglevel=info
beat: celery -A app beat --loglevel=info
redis: redis-server --port 6379
```

## Why Guv'nor?

### vs. Docker + docker-compose
```bash
# Old way (Docker)
$ docker-compose up -d          # Slow startup
$ docker-compose logs -f        # Complex logging
$ vim docker-compose.yml        # Manual configuration

# New way (Guv'nor)  
$ guvnor init                   # Auto-detect everything
$ guvnor start                  # Instant startup
```

### vs. nginx + systemd
```bash
# Old way (nginx + systemd)
$ sudo vim /etc/nginx/sites-available/myapp  # Manual config
$ sudo systemctl reload nginx                # Manual reload
$ sudo systemctl enable myapp               # Manual service
$ sudo certbot --nginx                      # Manual TLS

# New way (Guv'nor)
$ guvnor start --domain myapp.com --email admin@myapp.com  # Everything automatic
```

### vs. Kubernetes
```bash
# Old way (Kubernetes)
$ kubectl apply -f deployment.yaml    # Complex YAML
$ kubectl apply -f service.yaml       # More YAML  
$ kubectl apply -f ingress.yaml       # Even more YAML
$ kubectl get pods                    # Check status

# New way (Guv'nor)
$ guvnor init                         # Auto-detect
$ guvnor start                        # Just works
```

## Advanced Features

### Environment-Specific Deployment
```bash
# Development (automatic)
guvnor start --dev

# Production deployment
guvnor start --domain myapp.com --email admin@myapp.com

# Staging with test certificates
guvnor start --domain staging.myapp.com --email admin@myapp.com --staging
```

### Health Monitoring
```bash
# Built-in health monitoring
guvnor status

# Output:
# Process Status:
# PROCESS      STATUS   PID      COMMAND
# -------      ------   ---      -------
# web          running  1234     gunicorn app.wsgi
# worker       running  1235     celery -A app worker
# redis        running  1236     redis-server
```

### Process Management
- **Automatic Restarts**: Failed processes restart automatically
- **Health Checks**: HTTP/TCP/Command-based health monitoring  
- **Graceful Shutdown**: SIGTERM -> wait -> SIGKILL sequence
- **Resource Limits**: Memory and CPU constraints
- **Log Aggregation**: Centralized logging with rotation

## Installation

### Download Binary
```bash
# macOS/Linux
curl -sSL https://github.com/gleicon/guvnor/releases/latest/download/guvnor-$(uname -s)-$(uname -m) -o guvnor
chmod +x guvnor
sudo mv guvnor /usr/local/bin/

# Create short alias
sudo ln -sf /usr/local/bin/guvnor /usr/local/bin/gv

# Or with Go
go install github.com/gleicon/guvnor/cmd/guvnor@latest
```

### Build from Source  
```bash
git clone https://github.com/gleicon/guvnor.git
cd guvnor
make build

# This creates both guvnor and gv binaries
```

## Architecture

Guv'nor consists of:

- **Discovery Engine**: Auto-detects applications and frameworks
- **Process Manager**: Supervises application lifecycles  
- **Reverse Proxy**: Routes requests with TLS termination
- **Certificate Manager**: Automatic Let's Encrypt integration
- **Health Monitor**: Continuous application monitoring
- **Configuration Engine**: Smart defaults with override capability

## Comparison Matrix

| Feature | Guv'nor | nginx+systemd | Docker | Kubernetes |
|---------|---------|---------------|--------|------------|
| Setup Time | 0 seconds | 30+ minutes | 10+ minutes | Hours+ |
| Configuration | Zero | Complex | Moderate | Very Complex |
| TLS Setup | Automatic | Manual | Manual | Complex |
| Resource Usage | Minimal | Low | Moderate | High |
| Learning Curve | None | Moderate | Moderate | Steep |
| Production Ready | Yes | Yes | Yes | Yes |
| 12-Factor Apps | Native | Manual | Manual | Native |
| Single Binary | Yes | No | No | No |

## 12-Factor Application Support

Guv'nor has native support for 12-factor applications:

- **Procfile**: Native Procfile support (Heroku/Foreman compatible)
- **Environment Variables**: `.env` file support with variable substitution
- **Process Management**: Native process supervision and scaling
- **Logging**: Centralized log aggregation
- **Port Binding**: Automatic port assignment and routing
- **Disposability**: Graceful startup and shutdown

## Contributing

We welcome contributions! Please see:

- **Issues**: [GitHub Issues](https://github.com/gleicon/guvnor/issues)
- **Discussions**: [GitHub Discussions](https://github.com/gleicon/guvnor/discussions)
- **Pull Requests**: Follow standard GitHub workflow

## License

MIT License - see [LICENSE](LICENSE) file

## Support

- **Documentation**: [EXAMPLES.md](EXAMPLES.md) for detailed examples
- **Community**: [GitHub Discussions](https://github.com/gleicon/guvnor/discussions)  
- **Issues**: [GitHub Issues](https://github.com/gleicon/guvnor/issues)
- **Feature Requests**: [GitHub Issues](https://github.com/gleicon/guvnor/issues)

---

<p align="center">
<strong>Guv'nor: Simple, fast, reliable process management</strong><br>
<em>Zero configuration. Lightning fast. Just works.</em>
</p>